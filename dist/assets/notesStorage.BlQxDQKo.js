let A=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((r,n)=>(n&=63,n<36?r+=n.toString(36):n<62?r+=(n-26).toString(36).toUpperCase():n>62?r+="-":r+="_",r),"");const o="blinknote-items",i="#ffbd59",d=()=>{var e;return typeof chrome<"u"&&!!((e=chrome.storage)!=null&&e.local)},p=()=>{if(typeof window>"u")return[];const e=window.localStorage.getItem(o);return e?JSON.parse(e):[]},u=e=>{typeof window>"u"||window.localStorage.setItem(o,JSON.stringify(e))},l=e=>{const r=e.createdAt??Date.now(),n=e.updatedAt??r,a=e.color??i,s=e.title??(e.type==="link"?"Link":e.type==="image"?"Image":"Note"),t=e.order??r;return{id:e.id,title:s,type:e.type,content:e.content,createdAt:r,updatedAt:n,order:t,color:a,pinned:e.pinned??!1,reminder:e.reminder??null,lineage:Array.isArray(e.lineage)?e.lineage:[],sourceUrl:e.sourceUrl}},w=async()=>{const e=r=>(r??[]).map(n=>l(n));return d()?new Promise(r=>{chrome.storage.local.get([o],n=>{r(e(n[o]))})}):e(p())},f=async e=>{if(d())return new Promise(r=>{chrome.storage.local.set({[o]:e},()=>r())});u(e)},g=async e=>{const r=await w(),n=e(r);return await f(n),n},y=async e=>{const r=e.createdAt??Date.now();return g(n=>{const a=e.order??(n.length?Math.max(...n.map(t=>t.order))+1:1),s=l({...e,createdAt:r,updatedAt:e.updatedAt??r,order:a});return[...n,s].sort((t,c)=>t.pinned===c.pinned?t.order-c.order:c.pinned?1:-1)})};export{o as S,A as a,y as b,l as n,w as r,f as w};
